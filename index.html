<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ret√≥rica+ Literatura</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4a6fa5;
            --secondary: #6d9dc5;
            --accent: #f0544f;
            --light: #f7f9fc;
            --dark: #2c3e50;
            --gray: #e0e4e9;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: var(--dark);
            line-height: 1.6;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 1rem 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo {
            font-size: 2rem;
            font-weight: 800;
            display: flex;
            align-items: center;
        }
        
        .logo img {
            height: 50px;
            margin-right: 10px;
        }
        
        .literatura {
            font-size: 1.8rem;
            font-weight: 300;
            letter-spacing: 1px;
        }
        
        .search-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .search-box {
            position: relative;
        }
        
        .search-box input {
            padding: 10px 15px 10px 40px;
            border-radius: 30px;
            border: none;
            width: 300px;
            font-size: 1rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }
        
        .search-box input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(255,255,255,0.3);
        }
        
        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
        }
        
        nav {
            background-color: white;
            padding: 0.8rem 5%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            display: flex;
            justify-content: center;
        }
        
        .filters {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            background-color: var(--light);
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
        }
        
        .filter-btn:hover, .filter-btn.active {
            background-color: var(--primary);
            color: white;
        }
        
        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 20px;
        }
        
        .section-title {
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            color: var(--primary);
            position: relative;
            padding-bottom: 10px;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 70px;
            height: 4px;
            background-color: var(--accent);
            border-radius: 2px;
        }
        
        .catalog {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
        }
        
        .book-card {
            background-color: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .book-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 12px 20px rgba(0,0,0,0.15);
        }
        
        .book-cover {
            height: 320px;
            overflow: hidden;
        }
        
        .book-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }
        
        .book-card:hover .book-cover img {
            transform: scale(1.05);
        }
        
        .book-info {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .book-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--dark);
        }
        
        .book-author {
            color: var(--secondary);
            font-size: 1rem;
            margin-bottom: 15px;
        }
        
        .book-meta {
            display: flex;
            justify-content: space-between;
            margin-top: auto;
            font-size: 0.9rem;
            color: #666;
        }
        
        .book-meta div {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .quiz-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }
        
        .quiz-container.active {
            opacity: 1;
            visibility: visible;
        }
        
        .quiz-modal {
            background-color: white;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            border-radius: 15px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transform: translateY(30px);
            transition: var(--transition);
        }
        
        .quiz-container.active .quiz-modal {
            transform: translateY(0);
        }
        
        .quiz-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .quiz-title {
            font-size: 1.4rem;
            font-weight: 600;
        }
        
        .close-quiz {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }
        
        .close-quiz:hover {
            background-color: rgba(255,255,255,0.2);
        }
        
        .quiz-content {
            padding: 25px;
            overflow-y: auto;
            flex-grow: 1;
        }
        
        .question {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--gray);
        }
        
        .question:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .question-text {
            font-size: 1.2rem;
            margin-bottom: 15px;
            font-weight: 500;
        }
        
        .options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }
        
        .option {
            padding: 12px 15px;
            border: 2px solid var(--gray);
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .option:hover {
            border-color: var(--secondary);
            background-color: rgba(109, 157, 197, 0.05);
        }
        
        .option.selected {
            border-color: var(--primary);
            background-color: rgba(74, 111, 165, 0.1);
        }
        
        .quiz-footer {
            padding: 20px;
            background-color: var(--light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .progress {
            font-size: 1rem;
            color: var(--dark);
        }
        
        .quiz-buttons {
            display: flex;
            gap: 10px;
        }
        
        .quiz-btn {
            padding: 10px 25px;
            border: none;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .quiz-btn.prev {
            background-color: var(--gray);
            color: var(--dark);
        }
        
        .quiz-btn.next {
            background-color: var(--primary);
            color: white;
        }
        
        .quiz-btn.submit {
            background-color: var(--accent);
            color: white;
        }
        
        .quiz-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .results {
            text-align: center;
            padding: 30px;
        }
        
        .results-title {
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .score {
            font-size: 4rem;
            font-weight: 800;
            color: var(--accent);
            margin: 20px 0;
        }
        
        .score-text {
            font-size: 1.2rem;
            margin-bottom: 30px;
            color: #555;
        }
        
        .restart-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 35px;
            font-size: 1.1rem;
            border-radius: 30px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }
        
        .restart-btn:hover {
            background-color: var(--secondary);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .empty-state {
            grid-column: 1 / -1;
            text-align: center;
            padding: 50px 20px;
            color: #777;
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: var(--gray);
        }
        
        .empty-state h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: var(--dark);
        }
        
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 15px;
                padding: 15px 5%;
            }
            
            .search-box input {
                width: 100%;
            }
            
            .catalog {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .filters {
                justify-content: center;
            }
        }
        
        @media (max-width: 480px) {
            .logo {
                font-size: 1.6rem;
            }
            
            .literatura {
                font-size: 1.4rem;
            }
            
            .logo img {
                height: 40px;
            }
            
            .catalog {
                grid-template-columns: 1fr;
            }
            
            .quiz-modal {
                width: 95%;
            }
        }

        .book-categories {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .book-category {
            background-color: var(--secondary);
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <header>
        <div class="logo-container">
            <div class="logo">
                <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNTYgMjU2Ij48cmVjdCB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Ik0xMjgsMzJhOTYsOTYsMCwxLDAsOTYsOTZBOTYsOTYsMCwwLDAsMTI4LDMyWiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZmZmIiBzdHJva2Utd2lkdGg9IjE2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz48cGF0aCBkPSJNMTQ0LDEyOGgwYTMyLDMyLDAsMSwxLTMyLTMyIiBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS13aWR0aD0iMTYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPjxsaW5lIHgxPSIxMDQiIHkxPSIxNjAiIHgyPSIxNTIiIHkyPSIxNjAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIxNiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+PC9zdmc+" alt="Ret√≥rica+ Logo">
                Ret√≥rica+
            </div>
            <span class="literatura">Literatura</span>
        </div>
        
        <div class="search-container">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-input" placeholder="Pesquisar livros...">
            </div>
        </div>
    </header>
    
    <nav>
        <div class="filters" id="filters-container">
            
            <!-- Filtros ser√£o gerados dinamicamente -->
        </div>
    </nav>
    
    <div class="container">
        <h2 class="section-title">Cat√°logo de Livros</h2>
        <div class="catalog" id="catalog-container">
            <!-- Livros ser√£o gerados dinamicamente -->
        </div>
    </div>
    
    <div class="quiz-container" id="quiz-container">
        <div class="quiz-modal">
            <div class="quiz-header">
                <h3 class="quiz-title" id="quiz-title">Question√°rio</h3>
                <button class="close-quiz" id="close-quiz">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="quiz-content" id="quiz-content">
                <!-- Conte√∫do do question√°rio ser√° gerado aqui -->
            </div>
            <div class="quiz-footer">
                <div class="progress" id="quiz-progress">Pergunta 1 de 5</div>
                <div class="quiz-buttons">
                    <button class="quiz-btn prev" id="prev-btn">Anterior</button>
                    <button class="quiz-btn next" id="next-btn">Pr√≥xima</button>
                    <button class="quiz-btn submit" id="submit-btn">Enviar</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Dados dos livros
        const livros = [
            {
                id: 1,
                titulo: "Dom Casmurro",
                autor: "Machado de Assis",
                capa: "https://m.media-amazon.com/images/I/71k7mUfJ4pL._AC_UF1000,1000_QL80_.jpg",
                dataLancamento: "1899",
                categorias: ["Romance", "Fic√ß√£o Brasileira", "Realismo"],
                qtdPerguntas: 8,
                paginas: 256,
                tempoLeitura: 6,
                quizUrl: "dom_casmurro_quiz"
            },
            {
                id: 2,
                titulo: "1984",
                autor: "George Orwell",
                capa: "https://m.media-amazon.com/images/I/71kxa1-0mfL._AC_UF1000,1000_QL80_.jpg",
                dataLancamento: "1949",
                categorias: ["Fic√ß√£o Cient√≠fica", "Distopia", "Pol√≠tica"],
                qtdPerguntas: 10,
                paginas: 328,
                tempoLeitura: 8,
                quizUrl: "_1984_quiz"
            },
            {
                id: 3,
                titulo: "O Pequeno Pr√≠ncipe",
                autor: "Antoine de Saint-Exup√©ry",
                capa: "https://m.media-amazon.com/images/I/71gW7eS1wEL._AC_UF1000,1000_QL80_.jpg",
                dataLancamento: "1943",
                categorias: ["Literatura Infantil", "F√°bula", "Filosofia"],
                qtdPerguntas: 7,
                paginas: 96,
                tempoLeitura: 2,
                quizUrl: "pequeno_principe_quiz"
            },
            {
                id: 4,
                titulo: "Cem Anos de Solid√£o",
                autor: "Gabriel Garc√≠a M√°rquez",
                capa: "https://m.media-amazon.com/images/I/71vlYOO2dQL._AC_UF1000,1000_QL80_.jpg",
                dataLancamento: "1967",
                categorias: ["Realismo M√°gico", "Fic√ß√£o Latino-Americana", "√âpico"],
                qtdPerguntas: 12,
                paginas: 417,
                tempoLeitura: 12,
                quizUrl: "cem_anos_solidao_quiz"
            },
            {
                id: 5,
                titulo: "Orgulho e Preconceito",
                autor: "Jane Austen",
                capa: "https://m.media-amazon.com/images/I/71Q1tPupKjL._AC_UF1000,1000_QL80_.jpg",
                dataLancamento: "1813",
                categorias: ["Romance", "Literatura Inglesa", "Cl√°ssico"],
                qtdPerguntas: 9,
                paginas: 432,
                tempoLeitura: 10,
                quizUrl: "orgulho_preconceito_quiz"
            },
            {
                id: 6,
                titulo: "A Metamorfose",
                autor: "Franz Kafka",
                capa: "https://m.media-amazon.com/images/I/71B4j8W2D1L._AC_UF1000,1000_QL80_.jpg",
                dataLancamento: "1915",
                categorias: ["Fic√ß√£o Absurda", "Literatura Alem√£", "Existencialismo"],
                qtdPerguntas: 6,
                paginas: 104,
                tempoLeitura: 3,
                quizUrl: "metamorfose_quiz"
            }
        ];
        
        // Dados dos question√°rios
        const quizzes = {
            dom_casmurro_quiz: {
                livroId: 1,
                perguntas: [
                    {
                        id: 1,
                        pergunta: "Quem √© o narrador de Dom Casmurro?",
                        opcoes: ["Bentinho", "Capitu", "Escobar", "Sancha"],
                        respostaCorreta: 0
                    },
                    {
                        id: 2,
                        pergunta: "Qual √© a principal d√∫vida de Bentinho ao longo do romance?",
                        opcoes: [
                            "A fidelidade de Capitu", 
                            "A origem de sua fortuna", 
                            "Sua voca√ß√£o religiosa", 
                            "A identidade de seu pai"
                        ],
                        respostaCorreta: 0
                    },
                    {
                        id: 3,
                        pergunta: "Como Bentinho e Capitu se conheceram?",
                        opcoes: [
                            "Na escola", 
                            "Na igreja", 
                            "Foram vizinhos na inf√¢ncia", 
                            "Apresentados por Escobar"
                        ],
                        respostaCorreta: 2
                    },
                    {
                        id: 4,
                        pergunta: "Qual personagem tem os 'olhos de ressaca'?",
                        opcoes: ["Bentinho", "Capitu", "Escobar", "Dona Gl√≥ria"],
                        respostaCorreta: 1
                    }
                ]
            },
            _1984_quiz: {
                livroId: 2,
                perguntas: [
                    {
                        id: 1,
                        pergunta: "Qual √© o lema do Partido em 1984?",
                        opcoes: [
                            "Guerra √© Paz, Liberdade √© Escravid√£o, Ignor√¢ncia √© For√ßa", 
                            "Ordem e Progresso", 
                            "Liberdade, Igualdade, Fraternidade", 
                            "Trabalhadores do mundo, uni-vos"
                        ],
                        respostaCorreta: 0
                    },
                    {
                        id: 2,
                        pergunta: "Qual √© o nome do l√≠der supremo do Partido?",
                        opcoes: ["Big Brother", "Grande Irm√£o", "Grande L√≠der", "O Grande"],
                        respostaCorreta: 0
                    },
                    {
                        id: 3,
                        pergunta: "Onde Winston trabalha?",
                        opcoes: [
                            "Minist√©rio da Paz", 
                            "Minist√©rio da Verdade", 
                            "Minist√©rio do Amor", 
                            "Minist√©rio da Abund√¢ncia"
                        ],
                        respostaCorreta: 1
                    }
                ]
            },
            pequeno_principe_quiz: {
                livroId: 3,
                perguntas: [
                    {
                        id: 1,
                        pergunta: "Qual a profiss√£o do narrador do livro?",
                        opcoes: ["Piloto", "M√©dico", "Professor", "Astr√¥nomo"],
                        respostaCorreta: 0
                    },
                    {
                        id: 2,
                        pergunta: "Onde o Pequeno Pr√≠ncipe mora?",
                        opcoes: [
                            "Aster√≥ide B-612", 
                            "Planeta Terra", 
                            "Planeta Marte", 
                            "Estrela Alpha"
                        ],
                        respostaCorreta: 0
                    },
                    {
                        id: 3,
                        pergunta: "Qual a famosa frase do livro sobre o essencial?",
                        opcoes: [
                            "S√≥ se v√™ bem com o cora√ß√£o. O essencial √© invis√≠vel aos olhos.", 
                            "O essencial da vida √© lutar pelos sonhos.", 
                            "A ess√™ncia da felicidade est√° nas pequenas coisas.", 
                            "O essencial √© ter coragem para ser diferente."
                        ],
                        respostaCorreta: 0
                    }
                ]
            }
        };
        
        // Elementos DOM
        const catalogContainer = document.getElementById('catalog-container');
        const filtersContainer = document.getElementById('filters-container');
        const searchInput = document.getElementById('search-input');
        const quizContainer = document.getElementById('quiz-container');
        const quizContent = document.getElementById('quiz-content');
        const quizTitle = document.getElementById('quiz-title');
        const quizProgress = document.getElementById('quiz-progress');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const submitBtn = document.getElementById('submit-btn');
        const closeQuiz = document.getElementById('close-quiz');

        function getQtdPerguntas(quizId) {
            if (quizzes[quizId] && quizzes[quizId].perguntas) {
                return quizzes[quizId].perguntas.length;
            }
            return 0; // Retorna 0 se n√£o houver question√°rio
        }
        
        // Estado da aplica√ß√£o
        let currentFilter = 'all';
        let currentSearch = '';
        let currentQuiz = null;
        let currentQuestionIndex = 0;
        let userAnswers = {};
        
        // Extrair todas as categorias √∫nicas
        const allCategories = ['all'];
        livros.forEach(livro => {
            livro.categorias.forEach(categoria => {
                if (!allCategories.includes(categoria)) {
                    allCategories.push(categoria);
                }
            });
        });
        
        // Gerar bot√µes de filtro
        allCategories.forEach(categoria => {
            const btn = document.createElement('button');
            btn.className = 'filter-btn';
            if (categoria === 'all') btn.classList.add('active');
            btn.dataset.filter = categoria;
            btn.textContent = categoria === 'all' ? 'Todos' : categoria;
            filtersContainer.appendChild(btn);
        });
        
        // Renderizar cat√°logo
        function renderCatalog() {
            catalogContainer.innerHTML = '';
            
            const filteredLivros = livros.filter(livro => {
                // Aplicar filtro de categoria
                const filterMatch = currentFilter === 'all' || 
                                   livro.categorias.includes(currentFilter);
                
                // Aplicar filtro de pesquisa
                const searchMatch = livro.titulo.toLowerCase().includes(currentSearch.toLowerCase()) || 
                                   livro.autor.toLowerCase().includes(currentSearch.toLowerCase());
                
                return filterMatch && searchMatch;
            });
            
            if (filteredLivros.length === 0) {
                catalogContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-book-open"></i>
                        <h3>Nenhum livro encontrado</h3>
                        <p>Tente alterar seus filtros ou termos de pesquisa</p>
                    </div>
                `;
                return;
            }
            
            filteredLivros.forEach(livro => {
                // Obter quantidade REAL de perguntas
                const qtdRealPerguntas = getQtdPerguntas(livro.quizUrl);
                
                // Gerar HTML para as categorias (filtros)
                const categoriasHTML = livro.categorias.map(categoria => 
                    `<span class="book-category">${categoria}</span>`
                ).join('');
                
                const bookCard = document.createElement('div');
                bookCard.className = 'book-card';
                bookCard.dataset.id = livro.id;
                
                bookCard.innerHTML = `
                    <div class="book-cover">
                        <img src="${livro.capa}" alt="${livro.titulo}">
                    </div>
                    <div class="book-info">
                        <h3 class="book-title">${livro.titulo}</h3>
                        <p class="book-author">${livro.autor}</p>
                        
                        <!-- Adicionado: Exibi√ß√£o das categorias -->
                        <div class="book-categories">
                            ${categoriasHTML}
                        </div>
                        
                        <div class="book-meta">
                            <div>
                                <i class="fas fa-calendar"></i>
                                <span>${livro.dataLancamento}</span>
                            </div>
                            <div>
                                <i class="fas fa-question-circle"></i>
                                <span>${qtdRealPerguntas} perguntas</span>
                            </div>
                        </div>
                        <div class="book-meta">
                            <div>
                                <i class="fas fa-book"></i>
                                <span>${livro.paginas} p√°ginas</span>
                            </div>
                            <div>
                                <i class="fas fa-clock"></i>
                                <span>${livro.tempoLeitura} horas</span>
                            </div>
                        </div>
                    </div>
                `;
                
                bookCard.addEventListener('click', () => openQuiz(livro.quizUrl));
                catalogContainer.appendChild(bookCard);
            });
        }
        
        // Abrir question√°rio
        function openQuiz(quizId) {
            if (!quizzes[quizId]) {
                alert('Question√°rio ainda n√£o dispon√≠vel para este livro.');
                return;
            }
            
            currentQuiz = quizzes[quizId];
            currentQuestionIndex = 0;
            userAnswers = {};
            
            // Encontrar livro correspondente
            const livro = livros.find(l => l.quizUrl === quizId);
            quizTitle.textContent = `Question√°rio: ${livro.titulo}`;
            
            renderQuestion();
            quizContainer.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        // Renderizar pergunta atual
        function renderQuestion() {
            quizContent.innerHTML = '';
            
            const question = currentQuiz.perguntas[currentQuestionIndex];
            if (!question) return;
            
            const questionEl = document.createElement('div');
            questionEl.className = 'question';
            
            questionEl.innerHTML = `
                <h4 class="question-text">${currentQuestionIndex + 1}. ${question.pergunta}</h4>
                <div class="options" id="options-container"></div>
            `;
            
            quizContent.appendChild(questionEl);
            
            const optionsContainer = document.getElementById('options-container');
            question.opcoes.forEach((opcao, index) => {
                const optionEl = document.createElement('div');
                optionEl.className = 'option';
                if (userAnswers[question.id] === index) {
                    optionEl.classList.add('selected');
                }
                optionEl.textContent = opcao;
                optionEl.dataset.index = index;
                
                optionEl.addEventListener('click', () => {
                    // Remover sele√ß√£o anterior
                    document.querySelectorAll('.option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    
                    // Selecionar nova op√ß√£o
                    optionEl.classList.add('selected');
                    userAnswers[question.id] = index;
                });
                
                optionsContainer.appendChild(optionEl);
            });
            
            // Atualizar progresso
            quizProgress.textContent = `Pergunta ${currentQuestionIndex + 1} de ${currentQuiz.perguntas.length}`;
            
            // Atualizar bot√µes
            prevBtn.style.display = currentQuestionIndex > 0 ? 'block' : 'none';
            nextBtn.style.display = currentQuestionIndex < currentQuiz.perguntas.length - 1 ? 'block' : 'none';
            submitBtn.style.display = currentQuestionIndex === currentQuiz.perguntas.length - 1 ? 'block' : 'none';
        }
        
        // Navegar entre perguntas
        function navigateQuestion(direction) {
            if (direction === 'prev' && currentQuestionIndex > 0) {
                currentQuestionIndex--;
            } else if (direction === 'next' && currentQuestionIndex < currentQuiz.perguntas.length - 1) {
                currentQuestionIndex++;
            }
            
            renderQuestion();
        }
        
        // Submeter question√°rio
        function submitQuiz() {
            // Calcular pontua√ß√£o
            let score = 0;
            currentQuiz.perguntas.forEach(pergunta => {
                if (userAnswers[pergunta.id] === pergunta.respostaCorreta) {
                    score++;
                }
            });
            
            const percentage = Math.round((score / currentQuiz.perguntas.length) * 100);
            
            // Exibir resultados
            quizContent.innerHTML = `
                <div class="results">
                    <h3 class="results-title">Resultado do Question√°rio</h3>
                    <p>Voc√™ respondeu ${currentQuiz.perguntas.length} perguntas sobre o livro</p>
                    <div class="score">${percentage}%</div>
                    <p class="score-text">${score} de ${currentQuiz.perguntas.length} respostas corretas</p>
                    <button class="restart-btn" id="restart-btn">Refazer Question√°rio</button>
                </div>
            `;
            
            // Ocultar bot√µes de navega√ß√£o
            prevBtn.style.display = 'none';
            nextBtn.style.display = 'none';
            submitBtn.style.display = 'none';
            
            // Adicionar evento ao bot√£o de refazer
            document.getElementById('restart-btn').addEventListener('click', () => {
                currentQuestionIndex = 0;
                userAnswers = {};
                renderQuestion();
            });
        }
        
        // Fechar question√°rio
        function closeQuizModal() {
            quizContainer.classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        // Event Listeners
        filtersContainer.addEventListener('click', (e) => {
            if (e.target.classList.contains('filter-btn')) {
                // Atualizar bot√µes ativos
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                e.target.classList.add('active');
                
                // Atualizar filtro e renderizar
                currentFilter = e.target.dataset.filter;
                renderCatalog();
            }
        });
        
        searchInput.addEventListener('input', () => {
            currentSearch = searchInput.value;
            renderCatalog();
        });
        
        prevBtn.addEventListener('click', () => navigateQuestion('prev'));
        nextBtn.addEventListener('click', () => navigateQuestion('next'));
        submitBtn.addEventListener('click', submitQuiz);
        closeQuiz.addEventListener('click', closeQuizModal);
        quizContainer.addEventListener('click', (e) => {
            if (e.target === quizContainer) closeQuizModal();
        });
        
        // Inicializar
        renderCatalog();
    </script>
</body>
</html>